# âœ… pnpm æ”¯æŒä¿®å¤å®Œæˆ

## ğŸ”§ ä¿®å¤çš„é—®é¢˜

ä½ çš„é¡¹ç›®ä½¿ç”¨ pnpm ç®¡ç†ä¾èµ–ï¼Œä½† GitHub Actions å·¥ä½œæµä¸­ä½¿ç”¨çš„æ˜¯ npm å‘½ä»¤ï¼Œè¿™ä¼šå¯¼è‡´ä»¥ä¸‹é”™è¯¯ï¼š

- `npm ci` å‘½ä»¤åœ¨æ²¡æœ‰ `package-lock.json` æ—¶å¤±è´¥
- `npm run` å‘½ä»¤å¯èƒ½æ‰¾ä¸åˆ°ä¾èµ–
- ç¼“å­˜ç­–ç•¥ä¸åŒ¹é…å¯¼è‡´æ„å»ºæ—¶é—´å¢åŠ 

## âœ… å·²ä¿®å¤çš„æ–‡ä»¶

### 1. GitHub Actions å·¥ä½œæµ

#### `.github/workflows/ci-cd.yml`

- âœ… æ·»åŠ  `pnpm/action-setup@v2` æ­¥éª¤
- âœ… ä¿®æ”¹ç¼“å­˜ç­–ç•¥ä¸º `cache: 'pnpm'`
- âœ… æ›¿æ¢ `npm ci` â†’ `pnpm install --frozen-lockfile`
- âœ… æ›¿æ¢æ‰€æœ‰ `npm run` â†’ `pnpm run`
- âœ… æ›¿æ¢ `npm publish` â†’ `pnpm publish`
- âœ… ä¿®å¤æ‰“åŒ…æ£€æŸ¥å‘½ä»¤

#### `.github/workflows/auto-publish.yml`

- âœ… æ·»åŠ  pnpm è®¾ç½®æ­¥éª¤
- âœ… æ›´æ–°æ‰€æœ‰åŒ…ç®¡ç†å™¨å‘½ä»¤
- âœ… ä¿®æ”¹å®‰è£…ç¤ºä¾‹ä¸º `pnpm install`

#### `.github/workflows/manual-release.yml`

- âœ… å®Œæ•´çš„ pnpm æ”¯æŒ
- âœ… ç‰ˆæœ¬ç®¡ç†å‘½ä»¤æ›´æ–°
- âœ… å‘å¸ƒæµç¨‹ä¼˜åŒ–

### 2. é¡¹ç›®é…ç½®

#### `package.json`

- âœ… æ›´æ–°æ‰€æœ‰è„šæœ¬ä½¿ç”¨ `pnpm run`
- âœ… ä¿®å¤ `prepublishOnly` é’©å­
- âœ… æ›´æ–°å‘å¸ƒè„šæœ¬ (`release:patch/minor/major`)
- âœ… ä¿®å¤æ‰“åŒ…æ£€æŸ¥å‘½ä»¤

### 3. æ–‡æ¡£æ›´æ–°

#### `README.md`

- âœ… æ·»åŠ å¤šç§åŒ…ç®¡ç†å™¨å®‰è£…é€‰é¡¹
- âœ… åŒ…å« pnpm/npm/yarn çš„å®‰è£…ç¤ºä¾‹

#### `QUICK_SETUP.md`

- âœ… æ›´æ–°å¯†é’¥åç§°ä¸º `NPM_SUCKER_TOKEN`
- âœ… ä¿®æ”¹æ‰€æœ‰å‘½ä»¤ç¤ºä¾‹ä¸º pnpm
- âœ… æ›´æ–°æµ‹è¯•å’ŒéªŒè¯æµç¨‹

## ğŸš€ pnpm çš„ä¼˜åŠ¿

ä½¿ç”¨ pnpm æ›¿ä»£ npm çš„å¥½å¤„ï¼š

1. **æ›´å¿«çš„å®‰è£…é€Ÿåº¦** - ç¡¬é“¾æ¥å’Œç¬¦å·é“¾æ¥æœºåˆ¶
2. **èŠ‚çœç£ç›˜ç©ºé—´** - å…¨å±€å­˜å‚¨ï¼Œé¿å…é‡å¤
3. **æ›´ä¸¥æ ¼çš„ä¾èµ–ç®¡ç†** - é˜²æ­¢ phantom dependencies
4. **æ›´å¥½çš„ monorepo æ”¯æŒ** - åŸç”Ÿå·¥ä½œç©ºé—´æ”¯æŒ

## ğŸ“‹ éªŒè¯æ¸…å•

### âœ… æœ¬åœ°éªŒè¯

- [x] `pnpm install` æ­£å¸¸å®‰è£…ä¾èµ–
- [x] `pnpm run check` è¿è¡Œæ‰€æœ‰è´¨é‡æ£€æŸ¥
- [x] `pnpm run build` æˆåŠŸæ„å»ºé¡¹ç›®
- [x] `pnpm test` è¿è¡Œæµ‹è¯•
- [x] `pnpm run release:dry` æ£€æŸ¥æ‰“åŒ…å†…å®¹

### ğŸ”„ GitHub Actions éªŒè¯ (å¾…æµ‹è¯•)

- [ ] CI/CD å·¥ä½œæµæˆåŠŸè¿è¡Œ
- [ ] å¤š Node.js ç‰ˆæœ¬æµ‹è¯•é€šè¿‡
- [ ] è‡ªåŠ¨å‘å¸ƒæµç¨‹æ­£å¸¸å·¥ä½œ
- [ ] æ‰‹åŠ¨å‘å¸ƒåŠŸèƒ½å¯ç”¨

## ğŸ¯ ä¸‹ä¸€æ­¥æ“ä½œ

1. **æ¨é€æ›´æ”¹åˆ° GitHub**:

   ```bash
   git add .
   git commit -m "fix: update GitHub Actions to use pnpm instead of npm"
   git push origin main
   ```

2. **è®¾ç½® GitHub Secrets**:
   - åœ¨ GitHub ä»“åº“è®¾ç½®ä¸­æ·»åŠ  `NPM_SUCKER_TOKEN`

3. **æµ‹è¯•è‡ªåŠ¨å‘å¸ƒ**:
   ```bash
   # è§¦å‘ç‰ˆæœ¬æ›´æ–°å’Œè‡ªåŠ¨å‘å¸ƒ
   pnpm run release:patch
   ```

## ğŸ” æ•…éšœæ’é™¤

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. **pnpm ç‰ˆæœ¬å…¼å®¹æ€§**:
   - GitHub Actions ä½¿ç”¨ pnpm v8
   - ç¡®ä¿æœ¬åœ° pnpm ç‰ˆæœ¬å…¼å®¹

2. **ä¾èµ–å®‰è£…å¤±è´¥**:
   - æ£€æŸ¥ `pnpm-lock.yaml` æ–‡ä»¶æ˜¯å¦æäº¤
   - ä½¿ç”¨ `pnpm install --frozen-lockfile` ç¡®ä¿ä¸€è‡´æ€§

3. **å‘å¸ƒæƒé™é”™è¯¯**:
   - ç¡®è®¤ NPM_SUCKER_TOKEN æ­£ç¡®è®¾ç½®
   - æ£€æŸ¥ npm ä»¤ç‰Œç±»å‹ä¸º "Automation"

## ğŸ‰ å®Œæˆ

ä½ çš„é¡¹ç›®ç°åœ¨å®Œå…¨æ”¯æŒ pnpmï¼ŒGitHub Actions å·¥ä½œæµå·²ä¼˜åŒ–ï¼š

- âš¡ **æ›´å¿«çš„ CI/CD** - pnpm å®‰è£…é€Ÿåº¦æ›´å¿«
- ğŸ”’ **æ›´å¯é çš„æ„å»º** - ä¸¥æ ¼çš„ä¾èµ–ç®¡ç†
- ğŸ“¦ **ä¸€è‡´çš„ç¯å¢ƒ** - å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒç»Ÿä¸€ä½¿ç”¨ pnpm
- ğŸš€ **è‡ªåŠ¨åŒ–å‘å¸ƒ** - æ— ç¼çš„ç‰ˆæœ¬ç®¡ç†å’Œå‘å¸ƒæµç¨‹

ç°åœ¨å¯ä»¥å®‰å…¨åœ°æ¨é€åˆ° GitHub å¹¶äº«å—è‡ªåŠ¨åŒ–å‘å¸ƒæµç¨‹ï¼
